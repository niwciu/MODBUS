<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODBUS: D:/EMBEDDED/LIBRARIES/C_libraries/MODBUS/src/slave_internall/modbus_slave_PDU.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MODBUS<span id="projectnumber">&#160;v0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_3a6751ce2ddbeb7b1db61e747b4a3774.html">slave_internall</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">modbus_slave_PDU.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of Modbus slave protocol data unit (PDU) handling functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="modbus__slave___p_d_u_8h_source.html">modbus_slave_PDU.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="modbus___p_d_u__common_8h_source.html">modbus_PDU_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buf__rw_8h_source.html">buf_rw.h</a>&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for modbus_slave_PDU.c:</div>
<div class="dyncontent">
<div class="center"><img src="modbus__slave___p_d_u_8c__incl.png" border="0" usemap="#a_d_1_2_e_m_b_e_d_d_e_d_2_l_i_b_r_a_r_i_e_s_2_c__libraries_2_m_o_d_b_u_s_2src_2slave__internall_2modbus__slave___p_d_u_8c" alt=""/></div>
<map name="a_d_1_2_e_m_b_e_d_d_e_d_2_l_i_b_r_a_r_i_e_s_2_c__libraries_2_m_o_d_b_u_s_2src_2slave__internall_2modbus__slave___p_d_u_8c" id="a_d_1_2_e_m_b_e_d_d_e_d_2_l_i_b_r_a_r_i_e_s_2_c__libraries_2_m_o_d_b_u_s_2src_2slave__internall_2modbus__slave___p_d_u_8c">
<area shape="rect" title="Implementation of Modbus slave protocol data unit (PDU) handling functions." alt="" coords="260,5,444,80"/>
<area shape="rect" href="modbus__slave___p_d_u_8h.html" title="Header file for Modbus Slave Protocol Data Unit (PDU) handling." alt="" coords="70,128,218,155"/>
<area shape="poly" title=" " alt="" coords="274,83,186,124,184,119,271,78"/>
<area shape="rect" href="modbus___p_d_u__common_8h.html" title="Header file for common Modbus Protocol Data Unit (PDU) operations." alt="" coords="175,203,345,229"/>
<area shape="poly" title=" " alt="" coords="334,82,276,190,271,188,330,79"/>
<area shape="rect" href="buf__rw_8h.html" title="Header file for buffer read and write operations." alt="" coords="347,277,416,304"/>
<area shape="poly" title=" " alt="" coords="359,80,381,262,375,263,354,81"/>
<area shape="rect" title=" " alt="" coords="420,128,481,155"/>
<area shape="poly" title=" " alt="" coords="391,78,429,115,425,119,387,82"/>
<area shape="rect" href="modbus__slave__data_8h_source.html" title=" " alt="" coords="5,203,152,229"/>
<area shape="poly" title=" " alt="" coords="134,157,102,193,98,189,130,153"/>
<area shape="rect" href="modbus__type_8h.html" title="Header file defining types and constants for Modbus protocol implementation." alt="" coords="179,277,290,304"/>
<area shape="poly" title=" " alt="" coords="107,227,195,268,192,273,105,232"/>
<area shape="rect" href="modbus__config_8h.html" title="Defines configuration constants for a Modbus master application." alt="" coords="39,352,158,379"/>
<area shape="poly" title=" " alt="" coords="83,229,97,336,92,337,78,230"/>
<area shape="rect" href="modbus__public__type_8h.html" title="Defines public types and enums used in Modbus communication." alt="" coords="188,352,340,379"/>
<area shape="poly" title=" " alt="" coords="242,304,256,337,251,339,237,306"/>
<area shape="poly" title=" " alt="" coords="212,307,137,347,134,342,210,302"/>
<area shape="rect" title=" " alt="" coords="336,427,400,453"/>
<area shape="poly" title=" " alt="" coords="283,377,339,415,336,420,280,381"/>
<area shape="rect" title=" " alt="" coords="227,427,301,453"/>
<area shape="poly" title=" " alt="" coords="267,379,267,411,261,411,261,379"/>
<area shape="poly" title=" " alt="" coords="258,231,246,263,241,262,253,229"/>
<area shape="poly" title=" " alt="" coords="383,305,373,411,368,411,377,304"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a5875cef00c79af7f8420105e84db4052" id="r_a5875cef00c79af7f8420105e84db4052"><td class="memItemLeft" align="right" valign="top"><a id="a5875cef00c79af7f8420105e84db4052" name="a5875cef00c79af7f8420105e84db4052"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MODBUS_SLAVE_FUNCTION_MAPPER_SIZE</b>&#160;&#160;&#160;(sizeof(modbus_slave_function_mapper) / sizeof(modbus_slave_function_mapper[0]));</td></tr>
<tr class="separator:a5875cef00c79af7f8420105e84db4052"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abc0d5094b5a8712251cfd538c9c1f612" id="r_abc0d5094b5a8712251cfd538c9c1f612"><td class="memItemLeft" align="right" valign="top"><a class="el" href="modbus__type_8h.html#a218e678a2ab4e1d450d43db2773f3438">modbus_ret_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abc0d5094b5a8712251cfd538c9c1f612">parse_master_request_and_prepare_resp</a> (<a class="el" href="structmodbus__msg__t.html">modbus_msg_t</a> *rx_msg)</td></tr>
<tr class="memdesc:abc0d5094b5a8712251cfd538c9c1f612"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the Modbus master request and prepares the response.  <br /></td></tr>
<tr class="separator:abc0d5094b5a8712251cfd538c9c1f612"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of Modbus slave protocol data unit (PDU) handling functions. </p>
<dl class="section author"><dt>Author</dt><dd>niwciu (<a href="#" onclick="location.href='mai'+'lto:'+'niw'+'ci'+'u@g'+'ma'+'il.'+'co'+'m'; return false;">niwci<span class="obfuscator">.nosp@m.</span>u@gm<span class="obfuscator">.nosp@m.</span>ail.c<span class="obfuscator">.nosp@m.</span>om</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024-05-30</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2024 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="abc0d5094b5a8712251cfd538c9c1f612" name="abc0d5094b5a8712251cfd538c9c1f612"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc0d5094b5a8712251cfd538c9c1f612">&#9670;&#160;</a></span>parse_master_request_and_prepare_resp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="modbus__type_8h.html#a218e678a2ab4e1d450d43db2773f3438">modbus_ret_t</a> parse_master_request_and_prepare_resp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmodbus__msg__t.html">modbus_msg_t</a> *</td>          <td class="paramname"><span class="paramname"><em>rx_msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the Modbus master request and prepares the response. </p>
<p>This function processes the Modbus master request received in <code>rx_msg</code>. It checks for NULL pointers in the message structure and verifies the integrity of the request and response data buffers. If any of these conditions are not met, it returns RET_NULL_PTR_ERROR.</p>
<p>Upon successful validation, it identifies the function code from the request and searches for a corresponding function handler in the <code>modbus_slave_function_mapper</code>. If a matching handler is found, it invokes the associated function to process the request and prepares the response accordingly.</p>
<p>If no matching function handler is found in the mapper, it sets the response function code to indicate an illegal function error and sets an appropriate exception code in the response. It then returns RET_ERROR_UNKNOWN_MAPPER_FUN_CODE.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rx_msg</td><td>Pointer to the Modbus message structure containing the request and response data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>modbus_ret_t Status of the request parsing and response preparation. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">-</td><td>RET_OK if the request was parsed and response prepared successfully. </td></tr>
    <tr><td class="paramname">-</td><td>RET_NULL_PTR_ERROR if rx_msg, rx_msg-&gt;req.data, or rx_msg-&gt;resp.data is NULL. </td></tr>
    <tr><td class="paramname">-</td><td>RET_ERROR_UNKNOWN_MAPPER_FUN_CODE if an unsupported function code is detected. </td></tr>
    <tr><td class="paramname">-</td><td>RET_ERROR If an error occurred during validation or handling. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
