<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MODBUS: D:/EMBEDDED/LIBRARIES/C_libraries/MODBUS/src/common/modbus_RTU.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MODBUS<span id="projectnumber">&#160;v0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_fdedb0aba14d44ce9d99bc100e026e6a.html">common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">modbus_RTU.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation file for Modbus RTU communication protocol.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="modbus___r_t_u_8h_source.html">modbus_RTU.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="modbus__crc_8h_source.html">modbus_crc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buf__rw_8h_source.html">buf_rw.h</a>&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for modbus_RTU.c:</div>
<div class="dyncontent">
<div class="center"><img src="modbus___r_t_u_8c__incl.png" border="0" usemap="#a_d_1_2_e_m_b_e_d_d_e_d_2_l_i_b_r_a_r_i_e_s_2_c__libraries_2_m_o_d_b_u_s_2src_2common_2modbus___r_t_u_8c" alt=""/></div>
<map name="a_d_1_2_e_m_b_e_d_d_e_d_2_l_i_b_r_a_r_i_e_s_2_c__libraries_2_m_o_d_b_u_s_2src_2common_2modbus___r_t_u_8c" id="a_d_1_2_e_m_b_e_d_d_e_d_2_l_i_b_r_a_r_i_e_s_2_c__libraries_2_m_o_d_b_u_s_2src_2common_2modbus___r_t_u_8c">
<area shape="rect" title="Implementation file for Modbus RTU communication protocol." alt="" coords="237,5,421,64"/>
<area shape="rect" href="modbus___r_t_u_8h.html" title="Header file for Modbus RTU communication protocol implementation." alt="" coords="118,112,228,139"/>
<area shape="poly" title=" " alt="" coords="280,67,210,106,207,102,277,62"/>
<area shape="rect" href="modbus__crc_8h.html" title="Header file for Modbus CRC calculation." alt="" coords="252,187,355,213"/>
<area shape="poly" title=" " alt="" coords="327,65,311,172,305,171,322,64"/>
<area shape="rect" href="buf__rw_8h.html" title="Header file for buffer read and write operations." alt="" coords="380,187,449,213"/>
<area shape="poly" title=" " alt="" coords="345,63,382,137,402,172,397,175,377,140,340,66"/>
<area shape="rect" title=" " alt="" coords="392,112,453,139"/>
<area shape="poly" title=" " alt="" coords="361,62,400,99,396,103,357,66"/>
<area shape="rect" href="modbus__type_8h.html" title="Header file defining types and constants for Modbus protocol implementation." alt="" coords="118,187,228,213"/>
<area shape="poly" title=" " alt="" coords="176,139,176,171,170,171,170,139"/>
<area shape="rect" href="modbus__public__type_8h.html" title="Defines public types and enums used in Modbus communication." alt="" coords="5,261,157,288"/>
<area shape="poly" title=" " alt="" coords="156,141,131,162,109,188,95,217,88,247,82,245,90,216,104,185,127,158,152,137"/>
<area shape="poly" title=" " alt="" coords="159,216,110,254,107,250,155,212"/>
<area shape="rect" href="modbus__config_8h.html" title="Defines configuration constants for a Modbus master application." alt="" coords="181,261,301,288"/>
<area shape="poly" title=" " alt="" coords="187,212,221,248,217,252,183,216"/>
<area shape="rect" title=" " alt="" coords="306,336,371,363"/>
<area shape="poly" title=" " alt="" coords="127,286,292,332,291,337,125,291"/>
<area shape="rect" title=" " alt="" coords="44,336,118,363"/>
<area shape="poly" title=" " alt="" coords="84,289,84,320,78,320,78,289"/>
<area shape="poly" title=" " alt="" coords="309,213,335,320,329,322,304,214"/>
<area shape="poly" title=" " alt="" coords="410,215,354,323,349,321,405,213"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a37bdeebf867bda0c5bc4c4a2af4cc167" id="r_a37bdeebf867bda0c5bc4c4a2af4cc167"><td class="memItemLeft" align="right" valign="top"><a class="el" href="modbus__type_8h.html#a218e678a2ab4e1d450d43db2773f3438">modbus_ret_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a37bdeebf867bda0c5bc4c4a2af4cc167">modbus_RTU_send</a> (modbus_buf_t *buf, modbus_buf_size_t *msg_len, <a class="el" href="modbus__public__type_8h.html#a0337c9ebe7abd02e220ad7ca6e4ac29d">modbus_device_ID_t</a> slave_ID)</td></tr>
<tr class="memdesc:a37bdeebf867bda0c5bc4c4a2af4cc167"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a Modbus RTU message ready to send.  <br /></td></tr>
<tr class="separator:a37bdeebf867bda0c5bc4c4a2af4cc167"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af819eb2a50b22193da5c1a01b4c36f11" id="r_af819eb2a50b22193da5c1a01b4c36f11"><td class="memItemLeft" align="right" valign="top"><a class="el" href="modbus__type_8h.html#a218e678a2ab4e1d450d43db2773f3438">modbus_ret_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af819eb2a50b22193da5c1a01b4c36f11">modbus_RTU_recv</a> (modbus_buf_t *buf, modbus_buf_size_t msg_len, <a class="el" href="modbus__public__type_8h.html#a0337c9ebe7abd02e220ad7ca6e4ac29d">modbus_device_ID_t</a> slave_ID)</td></tr>
<tr class="memdesc:af819eb2a50b22193da5c1a01b4c36f11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receives and validates a Modbus RTU message.  <br /></td></tr>
<tr class="separator:af819eb2a50b22193da5c1a01b4c36f11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation file for Modbus RTU communication protocol. </p>
<p>This file implements functions declared in <a class="el" href="modbus___r_t_u_8h.html" title="Header file for Modbus RTU communication protocol implementation.">modbus_RTU.h</a> for sending and receiving Modbus messages using the RTU (Remote Terminal Unit) communication protocol. It includes functions to send a Modbus RTU message with CRC and receive a Modbus RTU message with CRC validation.</p>
<dl class="section author"><dt>Author</dt><dd>niwciu (<a href="#" onclick="location.href='mai'+'lto:'+'niw'+'ci'+'u@g'+'ma'+'il.'+'co'+'m'; return false;">niwci<span class="obfuscator">.nosp@m.</span>u@gm<span class="obfuscator">.nosp@m.</span>ail.c<span class="obfuscator">.nosp@m.</span>om</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024-05-14 </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.0.1</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2024 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af819eb2a50b22193da5c1a01b4c36f11" name="af819eb2a50b22193da5c1a01b4c36f11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af819eb2a50b22193da5c1a01b4c36f11">&#9670;&#160;</a></span>modbus_RTU_recv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="modbus__type_8h.html#a218e678a2ab4e1d450d43db2773f3438">modbus_ret_t</a> modbus_RTU_recv </td>
          <td>(</td>
          <td class="paramtype">modbus_buf_t *</td>          <td class="paramname"><span class="paramname"><em>buf</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">modbus_buf_size_t</td>          <td class="paramname"><span class="paramname"><em>msg_len</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modbus__public__type_8h.html#a0337c9ebe7abd02e220ad7ca6e4ac29d">modbus_device_ID_t</a></td>          <td class="paramname"><span class="paramname"><em>slave_ID</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receives and validates a Modbus RTU message. </p>
<p>This function receives a Modbus RTU message and validates it by checking the CRC and the slave ID. It ensures the integrity and correctness of the received message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Pointer to the buffer containing the received Modbus message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msg_len</td><td>Length of the received Modbus message, including the CRC. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slave_ID</td><td>ID of the Modbus slave device to validate against. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>modbus_ret_t The result of the validation.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RET_OK</td><td>The message was successfully received and validated. </td></tr>
    <tr><td class="paramname">RET_ERROR_SLAVE_ID</td><td>The received message contains an incorrect slave ID / slave address. </td></tr>
    <tr><td class="paramname">RET_ERROR_CRC</td><td>The calculated CRC from the received message is different from the CRC in the received message. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="modbus___r_t_u_8c_af819eb2a50b22193da5c1a01b4c36f11_cgraph.png" border="0" usemap="#amodbus___r_t_u_8c_af819eb2a50b22193da5c1a01b4c36f11_cgraph" alt=""/></div>
<map name="amodbus___r_t_u_8c_af819eb2a50b22193da5c1a01b4c36f11_cgraph" id="amodbus___r_t_u_8c_af819eb2a50b22193da5c1a01b4c36f11_cgraph">
<area shape="rect" title="Receives and validates a Modbus RTU message." alt="" coords="5,5,135,32"/>
<area shape="rect" href="modbus__crc_8c.html#a4d5c6b8a6ed3b6c55c2763e44534a2c3" title="Calculates CRC (Cyclic Redundancy Check) for given data buffer." alt="" coords="183,5,290,32"/>
<area shape="poly" title=" " alt="" coords="135,16,167,16,167,21,135,21"/>
</map>
</div>

</div>
</div>
<a id="a37bdeebf867bda0c5bc4c4a2af4cc167" name="a37bdeebf867bda0c5bc4c4a2af4cc167"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37bdeebf867bda0c5bc4c4a2af4cc167">&#9670;&#160;</a></span>modbus_RTU_send()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="modbus__type_8h.html#a218e678a2ab4e1d450d43db2773f3438">modbus_ret_t</a> modbus_RTU_send </td>
          <td>(</td>
          <td class="paramtype">modbus_buf_t *</td>          <td class="paramname"><span class="paramname"><em>buf</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">modbus_buf_size_t *</td>          <td class="paramname"><span class="paramname"><em>msg_len</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="modbus__public__type_8h.html#a0337c9ebe7abd02e220ad7ca6e4ac29d">modbus_device_ID_t</a></td>          <td class="paramname"><span class="paramname"><em>slave_ID</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a Modbus RTU message ready to send. </p>
<p>This function constructs a Modbus RTU message by appending the Modbus slave address and CRC to the message buffer. It also sets the correct length of the entire RTU message, ensuring it is ready for transmission.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">buf</td><td>Pointer to the buffer containing the Modbus PDU message. The buffer is updated with the slave address and CRC. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">msg_len</td><td>Pointer to the current size of the message buffer, updated to include the CRC. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slave_ID</td><td>ID of the Modbus slave device. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>modbus_ret_t The status of the message construction.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RET_OK</td><td>The message was successfully constructed and is ready to send. </td></tr>
    <tr><td class="paramname">RET_ERROR</td><td>An error occurred, such as a NULL buffer pointer or an invalid message length.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function requires the additional <code>modbus_crc</code> module for calculating the CRC to be placed in the message. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="modbus___r_t_u_8c_a37bdeebf867bda0c5bc4c4a2af4cc167_cgraph.png" border="0" usemap="#amodbus___r_t_u_8c_a37bdeebf867bda0c5bc4c4a2af4cc167_cgraph" alt=""/></div>
<map name="amodbus___r_t_u_8c_a37bdeebf867bda0c5bc4c4a2af4cc167_cgraph" id="amodbus___r_t_u_8c_a37bdeebf867bda0c5bc4c4a2af4cc167_cgraph">
<area shape="rect" title="Generates a Modbus RTU message ready to send." alt="" coords="5,5,140,32"/>
<area shape="rect" href="modbus__crc_8c.html#a4d5c6b8a6ed3b6c55c2763e44534a2c3" title="Calculates CRC (Cyclic Redundancy Check) for given data buffer." alt="" coords="188,5,295,32"/>
<area shape="poly" title=" " alt="" coords="140,16,172,16,172,21,140,21"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
